(()=>{"use strict";const e=wp.components,t=publishpress.i18n,r=wp.data,o=wp.element;function n(){return n=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)({}).hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e},n.apply(null,arguments)}var a=function(t){var r=t.children;return React.createElement(e.Fill,{name:"FutureActionPanelAfterActionField"},r)};a.Slot=function(t){return React.createElement(e.Slot,n({name:"FutureActionPanelAfterActionField"},t))};var l=futureWorkflows,c=l.apiUrl,u=l.nonce,i=l.workflows,s=function(n){var a=n.storeName,l=i.length>0?i[0].value:0,s=(0,r.useSelect)((function(e){var t=e("publishpress-future/future-action"),r=e("core/edit-post"),o=e("publishpress-future/future-action-quick-edit"),n=0;return t&&t.getPostId?n=t.getPostId():r&&r.getCurrentPostId?n=r.getCurrentPostId():o&&o.getPostId&&(n=o.getPostId()),{action:e(a).getAction(),workflowId:e(a).getExtraDataByName("workflowId")||l,postId:n,currentStoreWorkflowId:e(a).getExtraDataByName("workflowId")}})),f=s.action,w=s.workflowId,p=s.postId,d=s.currentStoreWorkflowId,g=(0,r.dispatch)(a).setExtraDataByName;return(0,o.useEffect)((function(){if(p)try{wp.apiFetch({url:"".concat(c,"/post-expiration/").concat(p),headers:{"X-WP-Nonce":u}}).then((function(e){g("workflowId",e.extraData.workflowId)}))}catch(e){console.error(e)}}),[]),w&&w!==d&&g("workflowId",w),React.createElement(React.Fragment,null,i.length>0&&"trigger-workflow"===f&&React.createElement(e.PanelRow,{className:"future-action-panel-content future-action-full-width"},React.createElement(e.SelectControl,{label:(0,t.__)("Workflow to trigger","post-expirator"),value:w,options:i,onChange:function(e){g("workflowId",e)},className:"future-action-workflow"}),React.createElement("input",{type:"hidden",name:"future_action_pro_workflow",value:w})),0===i.length&&"trigger-workflow"===f&&React.createElement(e.PanelRow,{className:"future-action-panel-content future-action-full-width"},React.createElement("p",null,(0,t.__)("No compatible workflows available.","post-expirator"))))};wp.plugins.registerPlugin("legacy-action-plugin",{render:function(){return React.createElement(a,null,(function(e){var t=e.storeName;return React.createElement(s,{storeName:t})}))},scope:"publishpress-future"})})();